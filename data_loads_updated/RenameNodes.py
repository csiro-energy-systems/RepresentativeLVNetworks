import os

def replace(filein, fileout, Replace_dict):
    #input file
    fin = open(dirname+"\\"+filein, "rt")
    #output file to write the result to
    fout = open(dirname+"\\"+fileout, "wt")
    #for each line in the input file
    for line in fin:
        for w in Replace_dict:
            #read replace the string and write to output file
            line = line.replace(w,Replace_dict[w])
        fout.write(line)
    #close input and output files
    fin.close()
    fout.close()




A_dict = {   "N350055":"55",  "N687957":"157", 
            "N687956":"56",  "N350054":"54"}

B_dict = {"N718880":"3", "N780464":"2", 
        "N416047":"1",  "N555254":"54",  "N555253":"53",
        "N555251":"51",  "N555252":"52"}

C_dict = {  "N478545":"45", "N477585":"85",
            "N478529":"29", "N478543":"43",
            "N478546":"46", "N478547":"47",
            "N748770":"70", "N748764":"64",
            "N478544":"44", "N748376":"76",
            "N478542":"42", "N478541":"41"}
            
D_dict = {  "N506359":"59",  "N761088":"088", "N506360":"60",  
            "N506334":"34",  "N761079":"079", "N506356":"56",
            "N506346":"46",  "N761083":"083", "N761087":"087",
            "N506362":"62",  "N506361":"61",  "N506334":"34",
            "N506364":"64",  "N761084":"084", "N506361":"61", 
            "N761089":"089", "N506348":"48",  "N506363":"63",
            "N761090":"090", "N506358":"58",  "N506357":"57"
}

E_dict = {  "N198238":"38",  "N198239":"39",  "N198235":"35",  "N198236":"36",
            "N198240":"40",  "N198241":"41",  "N198242":"42",  "N198247":"47",
            "N627731":"131", "N198249":"49",  "N627733":"133", "N198237":"37",
            "N198245":"45",  "N198242":"42",  "N198243":"43",  "N198248":"48",
            "N198240":"40",  "N198244":"44",  "N627730":"130", "N198246":"46", 
            "N193434":"234", "N627729":"179", "N198234":"34",  "N198233":"33", 
            "N626079":"379", "N627732":"132"} 

F_dict = {  "N119946":"46", "N119947":"47", "N119943":"43", "N119944":"44",
            "N119948":"48", "N599941":"141", "N119942":"42", "N599942":"142", 
            "N119951":"51", "N599944":"144", "N119945":"45", "N119949":"49",
            "N599945":"145", "N119950":"50", "N119941":"41", "N599943":"143"}

H_dict = {  "N310512":"12",   "N3105123":"13", "N310506":"06", "N310510":"10",
            "N310514":"14",   "N310515":"15",  "N310516":"16", "N310523":"23", 
            "N310524":"24",   "N310525":"25",  "N310526":"26", "N310529":"29",
            "N670976":"0976", "N310520":"20",  "N670978":"0978", "N310519":"19",
            "N670970":"0970", "N310517":"17",  "N670966":"0966", "N310521":"21",
            "N310511":"11",   "N670974":"0974", "N310518":"18", "N670973":"0973",
            "N670979":"0979", "N310527":"27",   "N670971":"0971", "N310511":"11",
            "N310528":"28",   "N670972":"0972", "N310522":"22", "N670968":"0968",
            "N670977":"0977", "N310509":"09", "N310506":"06", "N310508":"08",
            "N310509":"09", "N670969":"0969", "N670975":"0975" }

I_dict = {  "N034876":"76",  "N034877":"77", "N034875":"75" ,
            "N034873":"73",  "N034874":"74", "N034878":"78" , "N034879":"79" ,
            "N034872":"72" , "N034900":"1" , "N034871":"71",
            "N034880":"80",  "N034888":"88", "N034889":"89", "N034886":"86" ,
            "N034882":"82",  "N034884":"84", "N034881":"81", 
            "N034883":"83" , "N034885":"85", "N034887":"87" ,
            "N034898":"98",  "N034899":"99", "N034894":"94", "N034897":"97",  
            "N034895":"95",  "N034896":"96" , "N034892":"92", "N034890":"90", 
            "N034893":"93",  "N034891":"91" ,
            "N572970":"970", "N572973":"973", "N572979":"979",
            "N572980":"980", "N572971":"971", "N572976":"976", "N572974":"974",
            "N572972":"972", "N572975":"975", "N572977":"977", "N572978":"978"
}

K_dict = {  "N092515":"5", "N092516":"6", "N590529":"9",
            "N092514":"4", "N092513":"3"}

Dict_dict = {   "A.dss": A_dict,
                "B.dss": B_dict,
                "C.dss": C_dict,
                "D.dss": D_dict,
                "E.dss": E_dict,
                "F.dss": F_dict,
                "H.dss": H_dict,
                "I.dss": I_dict,
                "K.dss": K_dict
}

dirname = ".\\..\\data_loads_updated"
#for root, dir, files in os.walk("C:\\Users\\bri267\\OneDrive - CSIRO\\Documents\\RepresentativeLVNetworks\\data_loads_updated"):
for root, dir, files in os.walk(dirname):
    for file in files:
        print(file)
        if file[-3:]=="dss":
            replace(file, file[0]+"_out.txt", Dict_dict[file])

